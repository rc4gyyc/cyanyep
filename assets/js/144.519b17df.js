(window.webpackJsonp=window.webpackJsonp||[]).push([[144],{516:function(t,a,s){"use strict";s.r(a);var e=s(1),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"认识和安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#认识和安装"}},[t._v("#")]),t._v(" 认识和安装")]),t._v(" "),a("p",[t._v("Elasticsearch是由elastic公司开发的一套搜索引擎技术，它是elastic技术栈中的一部分。完整的技术栈包括：")]),t._v(" "),a("ul",[a("li",[t._v("Elasticsearch：用于"),a("strong",[t._v("数据存储、计算和搜索")])]),t._v(" "),a("li",[t._v("Logstash/Beats：用于"),a("strong",[t._v("数据收集")])]),t._v(" "),a("li",[t._v("Kibana：用于"),a("strong",[t._v("数据可视化")])])]),t._v(" "),a("p",[t._v("整套技术栈被称为ELK，经常用来做日志收集、系统监控和状态分析等等：")]),t._v(" "),a("h3",{attrs:{id:"安装内容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装内容"}},[t._v("#")]),t._v(" 安装内容")]),t._v(" "),a("ul",[a("li",[t._v("elasticsearch：存储、搜索和运算")]),t._v(" "),a("li",[t._v("kibana：图形化展示")])]),t._v(" "),a("p",[t._v("Elasticsearch是提供核心的数据存储、搜索、分析功能。")]),t._v(" "),a("p",[t._v("然后是Kibana，Elasticsearch对外提供的是"),a("strong",[t._v("Restful风格的API")]),t._v("，任何操作都可以通过发送http请求来完成。不过http请求的方式、路径、还有请求参数的格式都有严格的规范。这些规范我们肯定记不住，因此我们要借助于Kibana这个服务。")]),t._v(" "),a("p",[t._v("Kibana是elastic公司提供的用于操作Elasticsearch的可视化控制台。它的功能非常强大，包括：")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("对Elasticsearch数据的搜索、展示")])]),t._v(" "),a("li",[a("strong",[t._v("对Elasticsearch数据的统计、聚合，并形成图形化报表、图形")])]),t._v(" "),a("li",[a("strong",[t._v("对Elasticsearch的集群状态监控")])]),t._v(" "),a("li",[t._v("它还提供了一个开发控制台（DevTools），在其中对Elasticsearch的Restful的API接口提供了"),a("strong",[t._v("语法提示")])])]),t._v(" "),a("h3",{attrs:{id:"安装elasticsearch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装elasticsearch"}},[t._v("#")]),t._v(" 安装elasticsearch")]),t._v(" "),a("p",[t._v("通过下面的Docker命令即可安装单机版本的elasticsearch：")]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" es "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ES_JAVA_OPTS=-Xms512m -Xmx512m"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"discovery.type=single-node"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" es-data:/usr/share/elasticsearch/data "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" es-plugins:/usr/share/elasticsearch/plugins "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--privileged")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--network")]),t._v(" hm-net "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9200")]),t._v(":9200 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9300")]),t._v(":9300 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  elasticsearch:7.12.1\n")])])]),a("h3",{attrs:{id:"安装kibana⭐"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装kibana⭐"}},[t._v("#")]),t._v(" 安装Kibana⭐")]),t._v(" "),a("p",[t._v("通过下面的Docker命令，即可部署Kibana：")]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" kibana "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ELASTICSEARCH_HOSTS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("http://es:9200 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--network")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("hm-net "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5601")]),t._v(":5601  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\nkibana:7.12.1\n")])])]),a("p",[t._v("安装完成后，直接访问5601端口，即可看到控制台页面：")]),t._v(" "),a("p",[t._v("选择"),a("code",[t._v("Explore on my own")]),t._v("之后，进入主页面：")]),t._v(" "),a("p",[t._v("然后选中"),a("code",[t._v("Dev tools")]),t._v("，进入开发工具页面：")]),t._v(" "),a("h2",{attrs:{id:"倒排索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#倒排索引"}},[t._v("#")]),t._v(" 倒排索引")]),t._v(" "),a("p",[t._v("elasticsearch之所以有如此高性能的搜索表现，正是得益于底层的倒排索引技术。那么什么是倒排索引呢？")]),t._v(" "),a("p",[a("strong",[t._v("倒排")]),t._v("索引的概念是基于MySQL这样的"),a("strong",[t._v("正向")]),t._v("索引而言的。")]),t._v(" "),a("h3",{attrs:{id:"正向索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#正向索引"}},[t._v("#")]),t._v(" 正向索引")]),t._v(" "),a("p",[t._v("其中的"),a("code",[t._v("id")]),t._v("字段已经创建了索引，由于索引底层采用了B+树结构，因此我们根据id搜索的速度会非常快。但是其他字段例如"),a("code",[t._v("title")]),t._v("，只在叶子节点上存在。")]),t._v(" "),a("p",[t._v("因此要根据"),a("code",[t._v("title")]),t._v("搜索的时候只能遍历树中的每一个叶子节点，判断title数据是否符合要求。")]),t._v(" "),a("p",[t._v("综上，根据id精确匹配时，可以走索引，查询效率较高。而当搜索条件为模糊匹配时，由于索引无法生效，导致从索引查询退化为全表扫描，效率很差。")]),t._v(" "),a("p",[t._v("因此，"),a("strong",[t._v("正向索引适合于根据索引字段的精确搜索，不适合基于部分词条的模糊匹配")]),t._v("。")]),t._v(" "),a("p",[t._v("而倒排索引恰好解决的就是根据部分词条模糊匹配的问题。")]),t._v(" "),a("h3",{attrs:{id:"倒排索引-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#倒排索引-2"}},[t._v("#")]),t._v(" 倒排索引")]),t._v(" "),a("p",[t._v("倒排索引中有两个非常重要的概念：")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("文档")]),t._v("（"),a("code",[t._v("Document")]),t._v("）：用来搜索的数据，其中的每一条数据就是一个文档。例如一个网页、一个商品信息")]),t._v(" "),a("li",[a("strong",[t._v("词条")]),t._v("（"),a("code",[t._v("Term")]),t._v("）：对文档数据或用户搜索数据，利用某种算法分词，得到的具备含义的词语就是词条。例如：我是中国人，就可以分为：我、是、中国人、中国、国人这样的几个词条")])]),t._v(" "),a("p",[a("strong",[t._v("创建倒排索引")]),t._v("是对正向索引的一种特殊处理和应用，流程如下：")]),t._v(" "),a("ul",[a("li",[t._v("将每一个文档的数据利用"),a("strong",[t._v("分词算法")]),t._v("根据语义拆分，得到一个个词条")]),t._v(" "),a("li",[t._v("创建表，每行数据包括词条、词条所在文档id、位置（用于高亮）等信息")]),t._v(" "),a("li",[t._v("因为词条唯一性，可以给词条创建"),a("strong",[t._v("正向")]),t._v("索引")])]),t._v(" "),a("p",[a("strong",[t._v("正向索引")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[a("strong",[t._v("id（索引）")])]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[a("strong",[t._v("title")])]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[a("strong",[t._v("price")])])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("1")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("小米手机")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("3499")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("2")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("华为手机")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("4999")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("3")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("华为小米充电器")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("49")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("4")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("小米手环")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("49")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("...")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("...")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("...")])])])]),t._v(" "),a("p",[a("strong",[t._v("倒排索引")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[a("strong",[t._v("词条（索引）")])]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[a("strong",[t._v("文档id")])])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("小米")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("1，3，4")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("手机")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("1，2")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("华为")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("2，3")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("充电器")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("3")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("手环")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("4")])])])]),t._v(" "),a("p",[t._v("倒排索引的搜索流程描述：")]),t._v(" "),a("p",[t._v("1）用户输入条件"),a("code",[t._v('"华为手机"')]),t._v("进行搜索。")]),t._v(" "),a("p",[t._v("2）对用户输入条件分词，得到词条："),a("code",[t._v("华为")]),t._v("、"),a("code",[t._v("手机")]),t._v("。")]),t._v(" "),a("p",[t._v("3）拿着词条在倒排索引中查找（由于词条有索引，查询效率很高），即可得到包含词条的文档id："),a("code",[t._v("1、2、3")]),t._v("。")]),t._v(" "),a("p",[t._v("4）拿着文档"),a("code",[t._v("id")]),t._v("到正向索引中查找具体文档即可（由于"),a("code",[t._v("id")]),t._v("也有索引，查询效率也很高）。")]),t._v(" "),a("p",[t._v("虽然要先查询倒排索引，再查询倒排索引，但是无论是词条、还是文档id都建立了索引，查询速度非常快！无需全表扫描。")]),t._v(" "),a("h3",{attrs:{id:"正向和倒排⭐"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#正向和倒排⭐"}},[t._v("#")]),t._v(" 正向和倒排⭐")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("正向索引")]),t._v("是最传统的，根据id索引的方式。但根据词条查询时，必须先逐条获取每个文档，然后判断文档中是否包含所需要的词条，是"),a("strong",[t._v("根据文档找词条的过程")]),t._v("。")]),t._v(" "),a("li",[t._v("而"),a("strong",[t._v("倒排索引")]),t._v("则相反，是先找到用户要搜索的词条，根据词条得到保护词条的文档的id，然后根据id获取文档。是"),a("strong",[t._v("根据词条找文档的过程")]),t._v("。")])]),t._v(" "),a("h4",{attrs:{id:"优缺点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优缺点"}},[t._v("#")]),t._v(" 优缺点")]),t._v(" "),a("p",[a("strong",[t._v("正向索引")]),t._v("：")]),t._v(" "),a("ul",[a("li",[t._v("优点：\n"),a("ul",[a("li",[t._v("可以给多个字段创建索引")]),t._v(" "),a("li",[t._v("根据索引字段搜索、排序速度非常快")])])]),t._v(" "),a("li",[t._v("缺点：\n"),a("ul",[a("li",[t._v("根据非索引字段，或者索引字段中的部分词条查找时，只能全表扫描。")])])])]),t._v(" "),a("p",[a("strong",[t._v("倒排索引")]),t._v("：")]),t._v(" "),a("ul",[a("li",[t._v("优点：\n"),a("ul",[a("li",[t._v("根据词条搜索、模糊搜索时，速度非常快")])])]),t._v(" "),a("li",[t._v("缺点：\n"),a("ul",[a("li",[t._v("只能给词条创建索引，而不是字段")]),t._v(" "),a("li",[t._v("无法根据字段做排序")])])])]),t._v(" "),a("h2",{attrs:{id:"基础概念⭐⭐"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基础概念⭐⭐"}},[t._v("#")]),t._v(" 基础概念⭐⭐")]),t._v(" "),a("h3",{attrs:{id:"文档和字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文档和字段"}},[t._v("#")]),t._v(" 文档和字段")]),t._v(" "),a("p",[t._v("elasticsearch是面向**文档（Document）**存储的，可以是数据库中的一条商品数据，一个订单信息。文档数据会被序列化为"),a("code",[t._v("json")]),t._v("格式后存储在"),a("code",[t._v("elasticsearch")]),t._v("中：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[a("strong",[t._v("id（索引）")])]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[a("strong",[t._v("title")])]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[a("strong",[t._v("price")])])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("1")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("小米手机")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("3499")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("2")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("华为手机")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("4999")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("3")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("华为小米充电器")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("49")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("4")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("小米手环")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("49")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("...")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("...")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("...")])])])]),t._v(" "),a("div",{staticClass:"language-JSON extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"title"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"小米手机"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"price"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3499")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"title"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"华为手机"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"price"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4999")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"title"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"华为小米充电器"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"price"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("49")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"title"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"小米手环"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"price"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("299")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("因此，原本数据库中的一行数据就是ES中的一个JSON文档；而数据库中每行数据都包含很多列，这些列就转换为JSON文档中的"),a("strong",[t._v("字段（Field）")]),t._v("。")]),t._v(" "),a("h3",{attrs:{id:"索引和映射"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#索引和映射"}},[t._v("#")]),t._v(" 索引和映射")]),t._v(" "),a("p",[t._v("将类型相同的文档集中在一起管理，称为"),a("strong",[t._v("索引（Index）")]),t._v("。例如：")]),t._v(" "),a("p",[a("strong",[t._v("商品索引")])]),t._v(" "),a("div",{staticClass:"language-JSON extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"title"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"小米手机"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"price"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3499")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"title"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"华为手机"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"price"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4999")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"title"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"三星手机"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"price"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3999")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[a("strong",[t._v("用户索引")])]),t._v(" "),a("div",{staticClass:"language-JSON extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("101")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"张三"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"age"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("102")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"李四"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"age"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("103")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"麻子"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"age"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[a("strong",[t._v("订单索引")])]),t._v(" "),a("div",{staticClass:"language-JSON extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"userId"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("101")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"goodsId"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"totalFee"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("294")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"userId"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("102")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"goodsId"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"totalFee"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("328")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("因此，我们"),a("strong",[t._v("可以把索引当做是数据库中的表")]),t._v("。")]),t._v(" "),a("p",[t._v("数据库的表会有约束信息，用来定义表的结构、字段的名称、类型等信息。因此，索引库中就有"),a("strong",[t._v("映射（mapping）")]),t._v("，是"),a("strong",[t._v("索引中文档的字段约束信息，类似表的结构约束")]),t._v("。")]),t._v(" "),a("h3",{attrs:{id:"mysql与elasticsearch⭐"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql与elasticsearch⭐"}},[t._v("#")]),t._v(" mysql与elasticsearch⭐")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[a("strong",[t._v("MySQL")])]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[a("strong",[t._v("Elasticsearch")])]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[a("strong",[t._v("说明")])])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("Table")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("Index")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("索引(index)，就是文档的集合，类似数据库的表(table)")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("Row")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("Document")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("文档（Document），就是一条条的数据，类似数据库中的行（Row），文档都是JSON格式")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("Column")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("Field")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("字段（Field），就是JSON文档中的字段，类似数据库中的列（Column）")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("Schema")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("Mapping")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("Mapping（映射）是索引中文档的约束，例如字段类型约束。类似数据库的表结构（Schema）")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("SQL")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("DSL")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("DSL是elasticsearch提供的JSON风格的请求语句，用来操作elasticsearch，实现CRUD")])])])]),t._v(" "),a("ul",[a("li",[t._v("Mysql：擅长事务类型操作，可以确保数据的"),a("strong",[t._v("安全和一致性")])]),t._v(" "),a("li",[t._v("Elasticsearch：擅长海量数据的"),a("strong",[t._v("搜索、分析、计算")])])]),t._v(" "),a("p",[t._v("因此在企业中，往往是两者结合使用：")]),t._v(" "),a("ul",[a("li",[t._v("对安全性要求较高的写操作，使用mysql实现")]),t._v(" "),a("li",[t._v("对查询性能要求较高的搜索需求，使用elasticsearch实现")]),t._v(" "),a("li",[t._v("两者再基于某种方式，实现"),a("strong",[t._v("数据的同步")]),t._v("，保证一致性")])]),t._v(" "),a("h2",{attrs:{id:"ik分词器⭐"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ik分词器⭐"}},[t._v("#")]),t._v(" IK分词器⭐")]),t._v(" "),a("p",[t._v("Elasticsearch的关键就是倒排索引，而倒排索引依赖于"),a("strong",[t._v("对文档内容的分词")]),t._v("，而分词则需要高效、精准的分词算法，IK分词器就是这样一个中文分词算法。")]),t._v(" "),a("h3",{attrs:{id:"安装ik分词器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装ik分词器"}},[t._v("#")]),t._v(" 安装IK分词器")]),t._v(" "),a("p",[a("strong",[t._v("方案一")]),t._v("：在线安装")]),t._v(" "),a("p",[t._v("运行一个命令即可：")]),t._v(" "),a("div",{staticClass:"language-Shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exec")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-it")]),t._v(" es ./bin/elasticsearch-plugin  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.12.1/elasticsearch-analysis-ik-7.12.1.zip\n")])])]),a("p",[t._v("然后重启es容器：")]),t._v(" "),a("div",{staticClass:"language-Shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" restart es\n")])])]),a("p",[a("strong",[t._v("方案二")]),t._v("：离线安装")]),t._v(" "),a("p",[t._v("如果网速较差，也可以选择离线安装。")]),t._v(" "),a("p",[t._v("首先，查看之前安装的Elasticsearch容器的plugins数据卷目录：")]),t._v(" "),a("div",{staticClass:"language-Shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" volume inspect es-plugins\n")])])]),a("p",[t._v("结果如下：")]),t._v(" "),a("div",{staticClass:"language-JSON extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"CreatedAt"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2024-11-06T10:06:34+08:00"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"Driver"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"local"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"Labels"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token null keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"Mountpoint"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/var/lib/docker/volumes/es-plugins/_data"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"Name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"es-plugins"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"Options"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token null keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"Scope"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"local"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[t._v("可以看到elasticsearch的插件挂载到了"),a("code",[t._v("/var/lib/docker/volumes/es-plugins/_data")]),t._v("这个目录。我们需要把IK分词器上传至这个目录。")]),t._v(" "),a("p",[t._v("最后，重启es容器：")]),t._v(" "),a("div",{staticClass:"language-Shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" restart es\n")])])]),a("h3",{attrs:{id:"使用ik分词器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用ik分词器"}},[t._v("#")]),t._v(" 使用IK分词器")]),t._v(" "),a("p",[t._v("IK分词器包含两种模式：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("ik_smart")]),t._v("：智能语义切分")]),t._v(" "),a("li",[a("code",[t._v("ik_max_word")]),t._v("：最细粒度切分")])]),t._v(" "),a("p",[t._v("Elasticsearch官方提供的标准分词器：")]),t._v(" "),a("div",{staticClass:"language-JSON extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[t._v("POST /_analyze\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"analyzer"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"standard"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"text"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"黑马程序员学习java太棒了"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("标准分词器智能1字1词条，无法正确对中文做分词。")]),t._v(" "),a("h3",{attrs:{id:"拓展词典⭐"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#拓展词典⭐"}},[t._v("#")]),t._v(" 拓展词典⭐")]),t._v(" "),a("p",[t._v("随着互联网的发展，“造词运动”也越发的频繁。出现了很多新的词语，在原有的词汇列表中并不存在。比如：“泰裤辣”，“传智播客” 等。")]),t._v(" "),a("p",[t._v("所以要想正确分词，IK分词器的词库也需要不断的更新，IK分词器提供了扩展词汇的功能。")]),t._v(" "),a("p",[t._v("1）打开IK分词器config目录：")]),t._v(" "),a("p",[t._v("注意，如果采用在线安装的通过，默认是没有config目录的，需要把课前资料提供的ik下的config上传至对应目录。")]),t._v(" "),a("p",[t._v("在IKAnalyzer.cfg.xml配置文件内容添加：")]),t._v(" "),a("p",[t._v("2）在IKAnalyzer.cfg.xml配置文件内容添加：")]),t._v(" "),a("div",{staticClass:"language-XML extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token prolog"}},[t._v('<?xml version="1.0" encoding="UTF-8"?>')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token doctype"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<!")]),a("span",{pre:!0,attrs:{class:"token doctype-tag"}},[t._v("DOCTYPE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token name"}},[t._v("properties")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token name"}},[t._v("SYSTEM")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://java.sun.com/dtd/properties.dtd"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("properties")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("comment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("IK Analyzer 扩展配置"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("comment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--用户可以在这里配置自己的扩展字典 *** 添加扩展词典--\x3e")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("entry")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("key")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("ext_dict"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("ext.dic"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("entry")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--用户可以在这里配置停用的字典 *** 添加停用词典--\x3e")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("entry")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("key")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("ext_dict"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("stopword.dic"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("entry")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("properties")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[t._v("3）在IK分词器的config目录新建一个 "),a("code",[t._v("ext.dic")]),t._v("，可以参考config目录下复制一个配置文件进行修改")]),t._v(" "),a("div",{staticClass:"language-Plain extra-class"},[a("pre",{pre:!0,attrs:{class:"language-plain"}},[a("code",[t._v("传智播客\n泰裤辣\n")])])]),a("p",[t._v("4）重启elasticsearch")]),t._v(" "),a("div",{staticClass:"language-Shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" restart es\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看 日志")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" logs "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" elasticsearch\n")])])]),a("h2",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),a("p",[t._v("分词器的作用是什么？")]),t._v(" "),a("ul",[a("li",[t._v("创建倒排索引时，对文档分词")]),t._v(" "),a("li",[t._v("用户搜索时，对输入的内容分词")])]),t._v(" "),a("p",[t._v("IK分词器有几种模式？")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("ik_smart")]),t._v("：智能切分，粗粒度")]),t._v(" "),a("li",[a("code",[t._v("ik_max_word")]),t._v("：最细切分，细粒度")])]),t._v(" "),a("p",[t._v("IK分词器如何拓展词条？如何停用词条？")]),t._v(" "),a("ul",[a("li",[t._v("利用config目录的"),a("code",[t._v("IkAnalyzer.cfg.xml")]),t._v("文件添加拓展词典和停用词典")]),t._v(" "),a("li",[t._v("在词典中添加拓展词条或者停用词条")])])])}),[],!1,null,null,null);a.default=n.exports}}]);