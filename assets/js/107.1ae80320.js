(window.webpackJsonp=window.webpackJsonp||[]).push([[107],{475:function(t,s,n){"use strict";n.r(s);var a=n(0),e=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("ul",[s("li",[s("p",[t._v("driver.window_handles获取打开的所有窗口句柄，是一个列表。")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("所谓句柄(handles),就是窗口的唯一标识，系统通过窗口的句柄来区分不同的窗口。")])]),t._v(" "),s("li",[s("p",[t._v("列表中每个窗口句柄的出现顺序是窗口的启动顺序，所有最后启动的那个窗口的句柄就是列表最后一个成员（索引号是-1）")])])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("切换到最新窗口的步骤：")])]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("list1=driver.window_handles")])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("driver.switch_to.window(list1[-1])")])])])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("获得当前窗口句柄")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("driver.current_window_handle")])])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("关闭窗口有两种方法：")])]),t._v(" "),s("ul",[s("li",[s("p",[t._v("driver.quit0→关闭本次运行期间所启动的所有浏览器窗口，退出驱动程序，一般用于程序末尾，测试结束时使用。")])]),t._v(" "),s("li",[s("p",[t._v("driver.close(0→关闭当前一个浏览器窗口，保留其他浏览器窗口，一般用于业务步骤之间，属于一个测试中间的操作步骤。")])])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("所有的操作只针对当前窗口：")])]),t._v(" "),s("ul",[s("li",[t._v("比如close只关闭当前一个窗口，find_element查找元素只在当前窗口里查找。")])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("没有执行窗口切换的代码时，当前窗口就是最初启动的窗口")]),t._v("。")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("当前窗口已经被关闭以后，不会自动切换到其他窗口")])]),t._v(" "),s("ul",[s("li",[t._v("就算其他窗口只有一个，也不会自动变为当前窗口。")])])]),t._v(" "),s("li",[s("p",[t._v("NoSuchWindowException异常原因：")]),t._v(" "),s("ul",[s("li",[t._v("当前窗口已经被关闭，或要切换到的目标窗口句柄不正确。")])])])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("driver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("By"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("LINK_TEXT"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"EC"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("click"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#打开一个新窗口")]),t._v("\n\na"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("driver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("current_window_handle"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#获取当前窗口句柄")]),t._v("\nLst1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("driver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("window_handles"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#获取所有窗口句柄")]),t._v("\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("switch_to"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lst1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#切换到最新窗口")]),t._v("\n\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("By"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("LINK_TEXT"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ECShop "')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("click"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#新窗口")]),t._v("\n\nLst2"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("driver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("window_handles\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("switch_to"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lst2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#切换到最新窗口")]),t._v("\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("close"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#关闭当前窗口")]),t._v("\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("switch_to"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#切换到最初窗口")]),t._v("\n")])])]),s("ul",[s("li",[s("p",[t._v("切换窗口语法总结：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("driver.current_window_handle→获得当前浏览器窗口句柄")])]),t._v(" "),s("li",[s("p",[t._v("driver.windows_handles→获得所有浏览器窗口句柄(List)")])]),t._v(" "),s("li",[s("p",[t._v("driver.switch_to.window(窗口句柄)→切换到特定窗口")])]),t._v(" "),s("li",[s("p",[t._v("driver.close()→关闭当前一个浏览器窗口")])]),t._v(" "),s("li",[s("p",[t._v("driver.quit()→关闭所有浏览器窗口")])])])])]),t._v(" "),s("p",[t._v("​")])])}),[],!1,null,null,null);s.default=e.exports}}]);