(window.webpackJsonp=window.webpackJsonp||[]).push([[117],{489:function(t,s,a){"use strict";a.r(s);var n=a(1),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h3",{attrs:{id:"文件上传"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#文件上传"}},[t._v("#")]),t._v(" 文件上传")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("文件上传遇到的问题")]),t._v(" "),s("ul",[s("li",[t._v("文件上传，如果"),s("strong",[t._v("按照手工方式操作，需要操作Windows对话框")]),t._v("，而Selenium默认只能操作浏览器里的网页，不能操作Windows对话框。")])])]),t._v(" "),s("li",[s("strong",[t._v("Selenium标准文件上传")]),t._v(" "),s("ul",[s("li",[t._v("Selenium"),s("strong",[t._v("针对file类型的input")]),t._v("标记封装了现成的文件上传操作。")]),t._v(" "),s("li",[t._v('标准文件上传的“浏览”、“选择文件"或“上传”按钮是文件型按钮，语法如下：\n'),s("ul",[s("li",[s("code",[t._v('<input type="file" name="file_name">')])])])]),t._v(" "),s("li",[t._v("进行文件上传的语法\n"),s("ul",[s("li",[t._v('driver.find_element(By.NAME,"file").send_keys(r"D:\\111.txt")')])])])])]),t._v(" "),s("li",[t._v("文件路径"),s("strong",[t._v("支持绝对路径")]),t._v("，不支持相对路径（.或…)，需要采用os模块里的path相关函数：(os.getcwd()获取当前目录的绝对路径)\n"),s("ul",[s("li",[t._v('filepath=os.path.join(os.path.dirname(os.getcwd()),"temp","111.txt")')]),t._v(" "),s("li",[t._v('driver.find_element(By.ID,"file").send_keys(filepath)')])])]),t._v(" "),s("li",[t._v("语法说明：\n"),s("ul",[s("li",[s("strong",[t._v("os.getcwd()用于返回当前工作目录的绝对路径")]),t._v("。")]),t._v(" "),s("li",[s("strong",[t._v("os.path.dirname(path)函数返回参数的文件或文件夹所在的目录")])]),t._v(" "),s("li",[s("strong",[t._v("os.path.join(path1,path2…)函数拼接两个或更多的路径")])])])])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("driver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("By"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"file"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("send_keys"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"c:\\\\pp\\\\222.txt"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#预览上传文件")]),t._v("\n\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("By"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("NAME"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"submit"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("click"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#点击上传")]),t._v("\n")])])]),s("ul",[s("li",[s("p",[t._v("小结")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Selenium只能针对file类型的input进行文件上传"),s("code",[t._v('<input type="file" name="file_name">')])]),t._v(" "),s("ul",[s("li",[t._v("进行文件上传的语法\n"),s("ul",[s("li",[s("code",[t._v('driver.find_element(By.NAME,"file").send_keys(r"D:\\111.txt")')])])])])])]),t._v(" "),s("li",[s("p",[t._v("文件路径"),s("strong",[t._v("支持绝对路径")]),t._v("，不支持相对路径，用"),s("code",[t._v("os.getcwd()")]),t._v("获取当前目录的绝对路径")])])])])]),t._v(" "),s("h3",{attrs:{id:"文件下载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#文件下载"}},[t._v("#")]),t._v(" 文件下载")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("火狐浏览器下载配置")]),t._v(" "),s("ul",[s("li",[t._v('关于火孤浏览器的参数，可以通过在Firefox浏览器地址栏中输入"about:config"查看，设置好配置信息后，在重新启动浏览器后浏览器就会根据这些配置进行运行或操作。')])])]),t._v(" "),s("li",[s("p",[t._v("browser.download.folderList：设置Firefox的默认下载文件夹。")]),t._v(" "),s("ul",[s("li",[t._v('0是桌面；1是“我的下载"；2是自定义。')])])]),t._v(" "),s("li",[s("p",[t._v("browser.download.dir：下载文件存放目录。")]),t._v(" "),s("ul",[s("li",[t._v("如果browser.download.folderList=0，那么就不需要设置该参数。")])])]),t._v(" "),s("li",[s("p",[t._v("browser.download.manager.showWhenStarting：是否显示开始")]),t._v(" "),s("ul",[s("li",[t._v("True为显示开始，Flase为不显示开始。")])])]),t._v(" "),s("li",[s("p",[t._v("browser.helperApps.neverAsk.saveToDisk:对所给文件类型不再弹出框进行询问")]),t._v(" "),s("ul",[s("li",[t._v("在下载文件时，浏览器可能会弹出对应的下载提示框。")]),t._v(" "),s("li",[t._v("这个提示框是浏览器的，不能使用Selenium进行操作，所以可以通过该配置关闭提示。")]),t._v(" "),s("li",[t._v("上面例子中表示：对于下载类型为二进制流的文件不需要弹出提示。")]),t._v(" "),s("li",[t._v("常用的类型有：application/, octet-stream, application/vnd.ms-excel, text/csv,\napplication/zip, application/pdf, application/json,application/msword")])])])]),t._v(" "),s("p",[t._v("参考http://www.w3school.com.cn/media/media_mimeref.asp")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("文件扩展名")]),t._v(" "),s("th",[t._v("Content-Type(Mime-Type)")]),t._v(" "),s("th",[t._v("文件扩展名")]),t._v(" "),s("th",[t._v("Content-Type(Mime-Type)")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("*（二进制流）")]),t._v(" "),s("td",[t._v("application/octet-stream")]),t._v(" "),s("td",[t._v(".wav")]),t._v(" "),s("td",[t._v("audio/wav")])]),t._v(" "),s("tr",[s("td",[t._v(".ppt")]),t._v(" "),s("td",[t._v("application/vnd.ms-powerpoint")]),t._v(" "),s("td",[t._v(".xls")]),t._v(" "),s("td",[t._v("application/x-xls")])]),t._v(" "),s("tr",[s("td",[t._v(".html .htx .htm")]),t._v(" "),s("td",[t._v("text/html")]),t._v(" "),s("td",[t._v(".apk")]),t._v(" "),s("td",[t._v("application/vnd.android.package-archive")])]),t._v(" "),s("tr",[s("td",[t._v(".jpeg .jpg")]),t._v(" "),s("td",[t._v("image/jpeg")]),t._v(" "),s("td",[t._v(".cer")]),t._v(" "),s("td",[t._v("application/x-x509-ca-cert")])]),t._v(" "),s("tr",[s("td",[t._v(".mp3")]),t._v(" "),s("td",[t._v("audio/mp3")]),t._v(" "),s("td",[t._v(".rpm")]),t._v(" "),s("td",[t._v("audio/x-pn-realaudio-plugin")])]),t._v(" "),s("tr",[s("td",[t._v(".mp4")]),t._v(" "),s("td",[t._v("video/mpeg4")]),t._v(" "),s("td",[t._v(".dll")]),t._v(" "),s("td",[t._v("application/x-msdownload")])]),t._v(" "),s("tr",[s("td",[t._v(".png")]),t._v(" "),s("td",[t._v("image/png")]),t._v(" "),s("td",[t._v(".pdf")]),t._v(" "),s("td",[t._v("application/pdf")])]),t._v(" "),s("tr",[s("td",[t._v(".zip")]),t._v(" "),s("td",[t._v("application/zip")]),t._v(" "),s("td",[t._v(".doc")]),t._v(" "),s("td",[t._v("application/msword")])]),t._v(" "),s("tr",[s("td",[t._v(".json")]),t._v(" "),s("td",[t._v("application/json")]),t._v(" "),s("td",[t._v(".xml")]),t._v(" "),s("td",[t._v("applicaiton/xml")])])])]),t._v(" "),s("h4",{attrs:{id:"firefox启动配置-需要在调用webdriver的firefox-前配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#firefox启动配置-需要在调用webdriver的firefox-前配置"}},[t._v("#")]),t._v(" Firefox启动配置(需要在调用WebDriver的Firefox()前配置)")]),t._v(" "),s("p",[t._v("在调用WebDriver的Firefox()方法时设置信息会作为参数传递给浏览器。Firefox浏览器在启动、运行(下载)时就会根据这些设置信息进行操作：")]),t._v(" "),s("ul",[s("li",[t._v("实例化一个配置对象：配置对象=webdriver.FirefoxProfile()")]),t._v(" "),s("li",[t._v("通过配置对象添加配置信息：配置对象.set_preference(key,value)")]),t._v(" "),s("li",[t._v("以配置对象启动浏览器：webdriver.Firefox(firefox_profile=配置对象）")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("obj"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("webdriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FirefoxProfile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nobj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_preference"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"browser.download.folderList"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nobj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_preference"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"browser.download.dir"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"c:\\\\pp"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nobj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_preference"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"browser.download.manager.showWhenstarting"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nobj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_preference"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"browser.helperApps.neverAsk.saveToDisk"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"application/octet-stream"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndriver"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("webdriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Firefox"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("firefox_profile"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("obj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://www.firefox.com.cn/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("By"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("XPATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'//div[aid=\"download-button-thanks\"]/a'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("click"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsleep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("quit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("注意：遇到报错的情况，是因为FirefoxProfile()已经弃用，请把上面的代码更改如下：")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selenium"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webdriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("common"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("options "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" BaseOptions\nsetobj"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("webdriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FirefoxOptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsetobj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_preference"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("“browser"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("download"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("folderList”"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsetobj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_preference"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("“browser"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("download"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("dir")]),t._v("”"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("”c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\\\\temp\\\\”"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsetobj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_preference"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("“browser"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("download"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("manager"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("showWhenStarting”"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsetobj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_preference"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("“browser"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("helperApps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("neverAsk"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("saveToDisk”"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("”application"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("octet"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("stream”"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndriver"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("webdriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Firefox"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Options"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("setobj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("p",[t._v("参考来源：https://blog.csdn.net/huaalily/article/details/122492912")])])}),[],!1,null,null,null);s.default=e.exports}}]);